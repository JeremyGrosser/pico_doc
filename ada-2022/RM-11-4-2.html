<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Pragmas Assert and Assertion_Policy</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 4.3em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 4.0em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-11-4-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-11-4-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>11.4.2 Pragmas Assert and Assertion_Policy</H1>
<div class="paranum"><a name="p1">1/3</a></div>
<div class="Normal">Pragma Assert is used to assert the truth of a boolean 
expression at a point within a sequence of declarations or statements.</div>
<div class="paranum"><a name="p1.1">1.1/5</a></div>
<div class="Normal">&nbsp;Assert pragmas, subtype predicates (see <A HREF="RM-3-2-4.html">3.2.4</A>), 
preconditions and postconditions (see <A HREF="RM-6-1-1.html">6.1.1</A>), 
type invariants (see <A HREF="RM-7-3-2.html">7.3.2</A>), and default 
initial conditions (see <A HREF="RM-7-3-3.html">7.3.3</A>) are collectively 
referred to as <I>assertions</I>; their boolean expressions are referred 
to as <I>assertion expressions</I>.<A NAME="I5094"></A><A NAME="I5095"></A></div>
<div class="paranum"><a name="p1.2">1.2/3</a></div>
<div class="Normal">&nbsp;Pragma Assertion_Policy is used to control whether 
assertions are to be ignored by the implementation, checked at run time, 
or handled in some implementation-defined manner.&nbsp;</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum"><a name="p2">2/2</a></div>
<div class="Indented1" style="margin-bottom: 0.4em">The form of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert is as follows:&nbsp;</div>
<div class="paranum"><a name="p3">3/2</a></div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I5096"></A><A NAME="I5097"></A>Assert([Check 
=&gt;] <I>boolean_</I><A NAME="I5098"></A><SPAN Class="swiss"><A HREF="RM-4-4.html#S0132">expression</A></SPAN>[, 
[Message =&gt;] <I>string_</I><A NAME="I5099"></A><SPAN Class="swiss"><A HREF="RM-4-4.html#S0132">expression</A></SPAN>]);</div>
<div class="paranum"><a name="p4">4/2</a></div>
<div class="Indented1">A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert is allowed at the place where a <SPAN Class="swiss"><A HREF="RM-3-11.html#S0087">declarative_item</A></SPAN> 
or a <SPAN Class="swiss"><A HREF="RM-5-1.html#S0167">statement</A></SPAN> 
is allowed.</div>
<div class="paranum"><a name="p5">5/2</a></div>
<div class="Indented1" style="margin-bottom: 0.4em">The form of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy is as follows:&nbsp;</div>
<div class="paranum"><a name="p6">6/2</a></div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I5100"></A><A NAME="I5101"></A>Assertion_Policy(<I>policy_</I><A NAME="I5102"></A><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>);</div>
<div class="paranum"><a name="p6.1">6.1/3</a></div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I5103"></A><A NAME="I5104"></A>Assertion_Policy(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<I>assertion_</I><A NAME="I5105"></A><SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0347">aspect_mark</A></SPAN> 
=&gt; <I>policy_</I><A NAME="I5106"></A><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{, <I>assertion_</I><A NAME="I5107"></A><SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0347">aspect_mark</A></SPAN> 
=&gt; <I>policy_</I><A NAME="I5108"></A><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>});</div>
<div class="paranum"><a name="p7">7/3</a></div>
<div class="Indented1"><A NAME="I5109"></A><A NAME="I5110"></A>A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy is allowed only immediately within a <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN>, 
immediately within a <SPAN Class="swiss"><A HREF="RM-7-1.html#S0230">package_specification</A></SPAN>, 
or as a configuration pragma.</div>

<H4 Class="centered">Name Resolution Rules</H4>
<div class="paranum"><a name="p8">8/2</a></div>
<div class="Normal">The expected type for the <I>boolean_</I><SPAN Class="swiss"><A HREF="RM-4-4.html#S0132">expression</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert is any boolean type. The expected type for the <I>string_</I><SPAN Class="swiss"><A HREF="RM-4-4.html#S0132">expression</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert is type String.&nbsp;</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum"><a name="p9">9/5</a></div>
<div class="Normal">The <I>assertion_</I><SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0347">aspect_mark</A></SPAN> 
of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy shall identify an <I>assertion aspect</I>,<A NAME="I5111"></A><A NAME="I5112"></A> 
namely one of Assert, Static_Predicate, Dynamic_Predicate, Pre, Pre'Class, 
Post, Post'Class, Type_Invariant, Type_Invariant'Class, Default_Initial_Condition, 
or some implementation-defined (assertion) <SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0347">aspect_mark</A></SPAN>. 
The <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN> 
shall be either Check, Ignore, or some implementation-defined <SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>. 
</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p10">10/3</a></div>
<div class="Normal">A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy determines for each assertion aspect named in the <SPAN Class="swiss"><A HREF="RM-2-8.html#S0020">pragma_argument_association</A></SPAN>s 
whether assertions of the given aspect are to be enforced by a runtime 
check. The <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN> 
Check requires that assertion expressions of the given aspect be checked 
that they evaluate to True at the points specified for the given aspect; 
the <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN> 
Ignore requires that the assertion expression not be evaluated at these 
points, and the runtime checks not be performed. Note that for subtype 
predicate aspects (see <A HREF="RM-3-2-4.html">3.2.4</A>), even when 
the applicable Assertion_Policy is Ignore, the predicate will still be 
evaluated as part of membership tests and Valid <SPAN Class="swiss"><A HREF="RM-4-1-4.html#S0100">attribute_reference</A></SPAN>s, 
and if static, will still have an effect on loop iteration over the subtype, 
and the selection of <SPAN Class="swiss"><A HREF="RM-5-4.html#S0177">case_statement_alternative</A></SPAN>s 
and <SPAN Class="swiss"><A HREF="RM-3-8-1.html#S0072">variant</A></SPAN>s.</div>
<div class="paranum"><a name="p10.1">10.1/3</a></div>
<div class="Normal">&nbsp;&nbsp;If no <I>assertion_</I><SPAN Class="swiss"><A HREF="RM-13-1-1.html#S0347">aspect_mark</A></SPAN>s 
are specified in the pragma, the specified policy applies to all assertion 
aspects.</div>
<div class="paranum"><a name="p10.2">10.2/5</a></div>
<div class="Normal">&nbsp;&nbsp;A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy applies to the named assertion aspects in a specific 
region, and applies to all assertion expressions associated with those 
aspects specified in that region. A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy given in a <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN> 
or immediately within a <SPAN Class="swiss"><A HREF="RM-7-1.html#S0230">package_specification</A></SPAN> 
applies from the place of the pragma to the end of the innermost enclosing 
declarative region. The region for a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy given as a configuration pragma is the declarative region 
for the entire compilation unit (or units) to which it applies.</div>
<div class="paranum"><a name="p10.3">10.3/3</a></div>
<div class="Normal">&nbsp;&nbsp;If a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy applies to a <SPAN Class="swiss"><A HREF="RM-12-3.html#S0315">generic_instantiation</A></SPAN>, 
then the <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy applies to the entire instance.</div>
<div class="paranum"><a name="p10.4">10.4/3</a></div>
<div class="Normal">&nbsp;&nbsp;If multiple Assertion_Policy pragmas apply to a 
given construct for a given assertion aspect, the assertion policy is 
determined by the one in the innermost enclosing region of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assertion_Policy specifying a policy for the assertion aspect. If no 
such Assertion_Policy pragma exists, the policy is implementation defined.</div>
<div class="paranum"><a name="p11">11/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">The following language-defined 
library package exists:</div>
<div class="paranum"><a name="p12">12/5</a></div>
<div class="Examples"><A NAME="I5113"></A><B>package</B>&nbsp;Ada.Assertions<BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;Pure&nbsp;<B>is</B></div>
<div class="paranum"><a name="p13">13/2</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I5114"></A>Assertion_Error&nbsp;:&nbsp;<B>exception</B>;</div>
<div class="paranum"><a name="p14">14/2</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I5115"></A>Assert(Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean);<BR>
&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I5116"></A>Assert(Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean;&nbsp;Message&nbsp;:&nbsp;<B>in</B>&nbsp;String);</div>
<div class="paranum"><a name="p15">15/2</a></div>
<div class="Examples"><B>end</B>&nbsp;Ada.Assertions;</div>
<div class="paranum"><a name="p16">16/3</a></div>
<div class="Normal">A compilation unit containing a check for an assertion 
(including a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert) has a semantic dependence on the Assertions library unit.</div>
<div class="paranum"><a name="p17">17/3</a></div>
<div class="Normal"><SPAN STYLE="font-size: 80%"><I>This paragraph was 
deleted.</I></SPAN></div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum"><a name="p18">18/3</a></div>
<div class="Normal">If performing checks is required by the Assert assertion 
policy in effect at the place of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert, the elaboration of the pragma consists of evaluating the boolean 
expression, and if the result is False, evaluating the Message argument, 
if any, and raising the exception Assertions.Assertion_Error, with a 
message if the Message argument is provided.<A NAME="I5117"></A><A NAME="I5118"></A></div>
<div class="paranum"><a name="p19">19/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">Calling the procedure 
Assertions.Assert without a Message parameter is equivalent to:</div>
<div class="paranum"><a name="p20">20/2</a></div>
<div class="Examples"><B>if</B>&nbsp;Check&nbsp;=&nbsp;False&nbsp;<B>then</B><BR>
&nbsp;&nbsp;&nbsp;<B>raise</B>&nbsp;Ada.Assertions.Assertion_Error;<BR>
<B>end</B>&nbsp;<B>if</B>;</div>
<div class="paranum"><a name="p21">21/2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">Calling the procedure 
Assertions.Assert with a Message parameter is equivalent to:</div>
<div class="paranum"><a name="p22">22/2</a></div>
<div class="Examples"><B>if</B>&nbsp;Check&nbsp;=&nbsp;False&nbsp;<B>then</B><BR>
&nbsp;&nbsp;&nbsp;<B>raise</B>&nbsp;Ada.Assertions.Assertion_Error&nbsp;<B>with</B>&nbsp;Message;<BR>
<B>end</B>&nbsp;<B>if</B>;</div>
<div class="paranum"><a name="p23">23/2</a></div>
<div class="Normal">The procedures Assertions.Assert have these effects 
independently of the assertion policy in effect.</div>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<div class="paranum"><a name="p23.1">23.1/5</a></div>
<div class="Normal">&nbsp;&nbsp;It is a bounded error to invoke a potentially blocking 
operation (see <A HREF="RM-9-5-1.html">9.5.1</A>) during the evaluation 
of an assertion expression associated with a call on, or return from, 
a protected operation. If the bounded error is detected, Program_Error 
is raised. If not detected, execution proceeds normally, but if it is 
invoked within a protected action, it can result in deadlock or a (nested) 
protected action.<A NAME="I5119"></A>&nbsp;</div>

<H4 Class="centered">Implementation Requirements</H4>
<div class="paranum"><a name="p23.2">23.2/5</a></div>
<div class="Normal">&nbsp;&nbsp;Any postcondition expression, type invariant expression, 
or default initial condition expression occurring in the specification 
of a language-defined unit is enabled (see <A HREF="RM-6-1-1.html">6.1.1</A>, 
<A HREF="RM-7-3-2.html">7.3.2</A>, and <A HREF="RM-7-3-3.html">7.3.3</A>).</div>
<div class="paranum"><a name="p23.3">23.3/5</a></div>
<div class="Normal">&nbsp;&nbsp;The evaluation of any such postcondition, type 
invariant, or default initial condition expression shall either yield 
True or propagate an exception from a <SPAN Class="swiss"><A HREF="RM-11-3.html#S0309">raise_expression</A></SPAN> 
that appears within the assertion expression.</div>
<div class="paranum"><a name="p23.4">23.4/5</a></div>
<div class="Normal">&nbsp;&nbsp;Any precondition expression occurring in the specification 
of a language-defined unit is enabled (see <A HREF="RM-6-1-1.html">6.1.1</A>) 
unless suppressed (see <A HREF="RM-11-5.html">11.5</A>). Similarly, any 
predicate checks for a subtype occurring in the specification of a language-defined 
unit are enabled (see <A HREF="RM-3-2-4.html">3.2.4</A>) unless suppressed.</div>

<H4 Class="centered">Implementation Permissions</H4>
<div class="paranum"><a name="p24">24/2</a></div>
<div class="Normal">Assertion_Error may be declared by renaming an implementation-defined 
exception from another package.&nbsp;</div>
<div class="paranum"><a name="p25">25/2</a></div>
<div class="Normal">Implementations may define their own assertion policies.</div>
<div class="paranum"><a name="p26">26/5</a></div>
<div class="Normal">If the result of a function call in an assertion 
is not used to determine the value of the assertion expression, an implementation 
is permitted to omit the function call. This permission applies even 
if the function has side effects.</div>
<div class="paranum"><a name="p27">27/5</a></div>
<div class="Normal">An implementation may disallow the specification 
of an assertion expression if the evaluation of the expression has a 
side effect such that an immediate reevaluation of the expression can 
produce a different value. Similarly, an implementation may disallow 
the specification of an assertion expression that is checked as part 
of a call on or return from a callable entity <I>C</I>, if the evaluation 
of the expression has a side effect such that the evaluation of some 
other assertion expression associated with the same call of (or return 
from) <I>C</I> can produce a different value than in the case when the 
first expression had not been evaluated.&nbsp;</div>
<div class="paranum"><a name="p28">28/5</a></div>
<div class="Notes">NOTE&nbsp;&nbsp;&nbsp;Normally, the boolean expression 
in a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Assert should not call functions that have significant side effects when 
the result of the expression is True, so that the particular assertion 
policy in effect will not affect normal operation of the program.&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-11-4-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-11-4-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
