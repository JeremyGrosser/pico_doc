<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Unchecked Storage Deallocation</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert4 {text-decoration: underline; color: rgb(153,0,0) }
    SPAN.delete4 {text-decoration: line-through; color: rgb(153,0,0) }
    SPAN.insert5 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete5 {text-decoration: line-through; color: rgb(0,102,0) }
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.WideAbove {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-top: 0.6em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 4.3em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.8em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 4.0em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.Enumerated-Body {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Enumerated-Term {float: left; font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 2.3em; margin-top: 0em; margin-bottom: 0em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,51,153)"><B>Annotated</B></SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)"><B>&nbsp;Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-13-11-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-13-11-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>13.11.2 Unchecked Storage Deallocation</H1>
<div class="paranum"><a name="p1">1</a></div>
<div class="Normal">[<A NAME="I6486"></A> <A NAME="I6487"></A><A NAME="I6488"></A><A NAME="I6489"></A><A NAME="I6490"></A>Unchecked 
storage deallocation of an object designated by a value of an access 
type is achieved by a call to an instance of the generic procedure Unchecked_Deallocation.] 
</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p2">2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">The following language-defined 
generic library procedure exists:&nbsp;</div>
<div class="paranum"><a name="p3">3/5</a></div>
<div class="Examples">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0229-1.TXT">AI05-0229-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0241-1.TXT">AI12-0241-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0302-1.TXT">AI12-0302-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0319-1.TXT">AI12-0319-1</A></I>} 
<B>generic</B><BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Object(&lt;&gt;)&nbsp;<B>is</B>&nbsp;<B>limited</B>&nbsp;<B>private</B>;<BR>
&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;Name&nbsp;&nbsp;&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;&nbsp;Object;<BR>
<A NAME="I6491"></A><B>procedure</B>&nbsp;Ada.Unchecked_Deallocation(X&nbsp;:&nbsp;<B>in</B>&nbsp;<B>out</B>&nbsp;Name)<BR>
&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;<span class="insert5">Preelaborate,&nbsp;Nonblocking,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Global&nbsp;=&gt;&nbsp;<B>in&nbsp;out</B>&nbsp;Name'Storage_Pool,<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>Convention&nbsp;=&gt;&nbsp;Intrinsic;<span class="delete5"><BR>
<B>pragma</B>&nbsp;Preelaborate(Ada.Unchecked_Deallocation);</span></div>
<div class="paranum"><a name="p3.a">3.a/3</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0229-1.TXT">AI05-0229-1</A></I>} 
The aspect Convention implies that the attribute Access is not allowed 
for instances of Unchecked_Deallocation.&nbsp;</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum"><a name="p3.1">3.1/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0157-1.TXT">AI05-0157-1</A></I>} 
A call on an instance of Unchecked_Deallocation is illegal if the actual 
access type of the instance is a type for which the Storage_Size has 
been specified by a static expression with value zero or is defined by 
the language to be zero. <A NAME="I6492"></A>In addition to the places 
where Legality Rules normally apply (see <A HREF="AA-12-3.html">12.3</A>), 
this rule applies also in the private part of an instance of a generic 
unit.</div>
<div class="paranum"><a name="p3.b">3.b/3</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>This rule is the same as 
the rule for <SPAN Class="swiss"><A HREF="AA-4-8.html#S0164">allocator</A></SPAN>s. 
We could have left the last sentence out, as a call to Unchecked_Deallocation 
cannot occur in a specification as it is a procedure call, but we left 
it for consistency and to avoid future maintenance hazards.&nbsp;</div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum"><a name="p4">4</a></div>
<div class="Normal" style="margin-bottom: 0.4em">Given an instance of 
Unchecked_Deallocation declared as follows:&nbsp;</div>
<div class="paranum"><a name="p5">5</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Free&nbsp;<B>is</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;<B>new</B>&nbsp;Ada.Unchecked_Deallocation(<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>object_subtype_name</I></SPAN>,&nbsp;<SPAN Class="roman"><I>access_to_variable_subtype_name</I></SPAN>);</div>
<div class="paranum"><a name="p6">6</a></div>
<div class="WideAbove" style="margin-bottom: 0.4em">Procedure Free has 
the following effect:&nbsp;</div>
<div class="paranum"><a name="p7">7</a></div>
<div class="Enumerated-Term">1.</div><div class="Enumerated-Body">
After executing Free(X), the value of X is <B>null</B>.</div>
<div class="paranum"><a name="p8">8</a></div>
<div class="Enumerated-Term">2.</div><div class="Enumerated-Body">
Free(X), when X is already equal to <B>null</B>, has no effect.</div>
<div class="paranum"><a name="p9">9/5</a></div>
<div class="Enumerated-Term">3.</div><div class="Enumerated-Body">
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0107-1.TXT">AI05-0107-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0445-1.TXT">AI12-0445-1</A></I>} 
Free(X), when X is not equal to <B>null</B> first performs finalization 
of the object designated by X (and any coextensions of the object &mdash; 
see <A HREF="AA-3-10-2.html">3.10.2</A>), as described in <A HREF="AA-7-6-1.html">7.6.1</A>. 
It then deallocates the storage occupied by the object designated by 
X (and any coextensions). If the storage pool is a user-defined object, 
then the storage is deallocated by calling Deallocate as described in 
<A HREF="AA-13-11.html">13.11</A>. There is one exception: if the object 
being freed contains tasks, <span class="insert5">it is unspecified whether 
</span>the object <span class="insert5">is</span><span class="delete5">&nbsp;might 
not be</span> deallocated.&nbsp;</div>
<div class="paranum"><a name="p9.a">9.a/3</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0107-1.TXT">AI05-0107-1</A></I>} 
Free calls only the specified Deallocate procedure to do deallocation. 
</div>
<div class="paranum"><a name="p10">10/4</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<A NAME="I6493"></A><A NAME="I6494"></A><A NAME="I6495"></A><A NAME="I6496"></A>After 
<span class="insert4">the finalization step of&nbsp;</span>Free(X), the object 
designated by X, and any subcomponents (and coextensions) thereof, no 
longer exist; their storage can be reused for other purposes.&nbsp;</div>

<H4 Class="centered">Bounded (Run-Time) Errors</H4>
<div class="paranum"><a name="p11">11</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><A NAME="I6497"></A>It 
is a bounded error to free a discriminated, unterminated task object. 
The possible consequences are:&nbsp;</div>
<div class="paranum"><a name="p11.a">11.a</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>This is an error because the 
task might refer to its discriminants, and the discriminants might be 
deallocated by freeing the task object.&nbsp;</div>
<div class="paranum"><a name="p12">12</a></div>
<div class="Bulleted">No exception is raised.</div>
<div class="paranum"><a name="p13">13</a></div>
<div class="Bulleted">Program_Error or Tasking_Error is raised at the 
point of the deallocation.<A NAME="I6498"></A> <A NAME="I6499"></A></div>
<div class="paranum"><a name="p14">14</a></div>
<div class="Bulleted">Program_Error or Tasking_Error is raised in the 
task the next time it references any of the discriminants.&nbsp;</div>
<div class="paranum"><a name="p14.a">14.a</a></div>
<div class="Annotations"><B>Implementation Note:&nbsp;</B>This last case presumes 
an implementation where the task references its discriminants indirectly, 
and the pointer is nulled out when the task object is deallocated.&nbsp;</div>
<div class="paranum"><a name="p15">15</a></div>
<div class="Normal">In the first two cases, the storage for the discriminants 
(and for any enclosing object if it is designated by an access discriminant 
of the task) is not reclaimed prior to task termination.&nbsp;</div>
<div class="paranum"><a name="p15.a">15.a</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>The storage might never 
be reclaimed.&nbsp;</div>
<div class="paranum"><a name="p15.1">15.1/4</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<span class="insert4">An access value that designates a nonexistent object 
is called a <I>dangling reference</I>.<A NAME="I6500"></A><A NAME="I6501"></A></span></div>
<div class="paranum"><a name="p15.b">15.b/4</a></div>
<div class="Annotations"><span class="insert4"><B>Discussion:&nbsp;</B>These 
can result from use of Unchecked_Deallocation, Unchecked_Deallocate_Subpool, 
and attribute Unchecked_Access. Bad results from Unchecked_Conversion 
and from stream-oriented attributes are abnormal by <A HREF="AA-13-9-1.html">13.9.1</A>, 
which is stronger and thus takes precedence.</span>&nbsp;</div>
<div class="paranum"><a name="p15.2">15.2/4</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<span class="insert4">[If a dangling reference is dereferenced (implicitly 
or explicitly), execution is erroneous (see below).] If there is no explicit 
or implicit dereference, then it is a bounded error <A NAME="I6502"></A>to 
evaluate an expression whose result is a dangling reference. If the error 
is detected, either Constraint_Error or Program_Error is raised. <A NAME="I6503"></A><A NAME="I6504"></A>Otherwise, 
execution proceeds normally, but with the possibility that the access 
value designates some other existing object.</span></div>
<div class="paranum"><a name="p15.c">15.c/4</a></div>
<div class="Annotations"><span class="insert4"><B>Reason:&nbsp;</B>If a dangling 
reference is compared with another access value, a result of either True 
or False is allowed. We need to allow this so that simple implementations 
of access values (for instance, as a bare address) can work if the memory 
in question is reused. (The formal definition of access equality is that 
it returns True if both access values designate the same object; that 
can never be True if one of the values is a dangling reference, and the 
other is not, but both values could refer to the same memory.) Membership 
tests that do not involve an implicit dereference generally do not depend 
on the access value at all.</span></div>
<div class="paranum"><a name="p15.d">15.d/4</a></div>
<div class="Annotations"><span class="insert4">We allow Constraint_Error 
to be raised here so that dangling reference and null pointer checks 
can be combined into a single check. If different exceptions are required, 
then the checks have to be made separately - but there's little semantic 
difference (neither designate a usable object).</span>&nbsp;</div>
<div class="paranum"><a name="p15.e">15.e/4</a></div>
<div class="Annotations"><span class="insert4"><B>Ramification:&nbsp;</B>If 
a dangling reference is assigned into an object, including being passed 
to a formal parameter, that object also contains a dangling reference 
afterwards.</span>&nbsp;</div>
<div class="paranum"><a name="p15.f">15.f/4</a></div>
<div class="Annotations"><span class="insert4"><B>Discussion:&nbsp;</B>For 
equality and membership operations on composite types, this applies to 
any parts that are access types, as these operations are created based 
on the operations of the components (which triggers the bounded error). 
For other operations on composite types, the bounded error is not triggered. 
For instance, an assignment of a composite object with a subcomponent 
that is a dangling reference has to work normally; no exception can be 
raised, but the target object will have a subcomponent that is a dangling 
references, and a (direct) use of that subcomponent is again a bounded 
error. This is similar to the way that assignments of invalid subcomponents 
are handled (see <A HREF="AA-13-9-1.html">13.9.1</A>).</span>&nbsp;</div>

<H4 Class="centered">Erroneous Execution</H4>
<div class="paranum"><a name="p16">16/3</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0033-1.TXT">AI05-0033-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
<A NAME="I6505"></A><A NAME="I6506"></A>Evaluating a name that denotes 
a nonexistent object, or a protected subprogram or subprogram renaming 
whose associated object (if any) is nonexistent, is erroneous. The execution 
of a call to an instance of Unchecked_Deallocation is erroneous if the 
object was created other than by an <SPAN Class="swiss"><A HREF="AA-4-8.html#S0164">allocator</A></SPAN> 
for an access type whose pool is Name'Storage_Pool.</div>
<div class="paranum"><a name="p16.a">16.a/3</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0033-1.TXT">AI05-0033-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0262-1.TXT">AI05-0262-1</A></I>} 
The part about a protected subprogram is intended to cover the case of 
an access-to-protected-subprogram where the associated object has been 
deallocated. The part about a subprogram renaming is intended to cover 
the case of a renaming of a prefixed view where the prefix object has 
been deallocated, or the case of a renaming of an entry or protected 
subprogram where the associated task or protected object has been deallocated. 
</div>
<div class="paranum"><a name="p16.b">16.b/3</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0157-1.TXT">AI05-0157-1</A></I>} 
This text does not cover the case of a name that contains a null access 
value, as <B>null</B> does not denote an object (rather than denoting 
a nonexistent object).&nbsp;</div>

<H4 Class="centered">Implementation Advice</H4>
<div class="paranum"><a name="p17">17</a></div>
<div class="Normal">For a standard storage pool, Free should actually 
reclaim the storage.&nbsp;</div>
<div class="paranum"><a name="p17.a.1">17.a.1/2</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>For a standard 
storage pool, an instance of Unchecked_Deallocation should actually reclaim 
the storage.</div>
<div class="paranum"><a name="p17.a">17.a/2</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00114.TXT">AI95-00114-01</A></I>} 
This is not a testable property, since we do not know how much storage 
is used by a given pool element, nor whether fragmentation can occur. 
</div>
<div class="paranum"><a name="p17.1">17.1/3</a></div>
<div class="Normal">&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0157-1.TXT">AI05-0157-1</A></I>} 
A call on an instance of Unchecked_Deallocation with a nonnull access 
value should raise Program_Error if the actual access type of the instance 
is a type for which the Storage_Size has been specified to be zero or 
is defined by the language to be zero.&nbsp;</div>
<div class="paranum"><a name="p17.a.1">17.a.1/3</a></div>
<div class="Annotations"><B>Implementation Advice:&nbsp;</B>A call on an instance 
of Unchecked_Deallocation with a nonnull access value should raise Program_Error 
if the actual access type of the instance is a type for which the Storage_Size 
has been specified to be zero or is defined by the language to be zero.</div>
<div class="paranum"><a name="p17.b">17.b</a></div>
<div class="Annotations"><B>Discussion:&nbsp;</B>If the call is not illegal 
(as in a generic body), we recommend that it raise Program_Error. Since 
the execution of this call is erroneous (any allocator from the pool 
will have raised Storage_Error, so the nonnull access value must have 
been allocated from a different pool or be a stack-allocated object), 
we can't require any behavior &mdash; anything at all would be a legitimate 
implementation.&nbsp;</div>
<div class="paranum"><a name="p18">18</a></div>
<div class="Notes">NOTE 1&nbsp;&nbsp;&nbsp;The rules here that refer 
to Free apply to any instance of Unchecked_Deallocation.</div>
<div class="paranum"><a name="p19">19</a></div>
<div class="Notes">NOTE 2&nbsp;&nbsp;&nbsp;Unchecked_Deallocation cannot 
be instantiated for an access-to-constant type. This is implied by the 
rules of <A HREF="AA-12-5-4.html">12.5.4</A>.&nbsp;</div>

<H4 Class="centered">Wording Changes from Ada 95</H4>
<div class="paranum"><a name="p19.a">19.a/2</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AIs/AI-00416.TXT">AI95-00416-01</A></I>} 
The rules for coextensions are clarified (mainly by adding that term). 
In theory, this reflects no change from Ada 95 (coextensions existed 
in Ada 95, they just didn't have a name).&nbsp;</div>

<H4 Class="centered">Wording Changes from Ada 2005</H4>
<div class="paranum"><a name="p19.b">19.b/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0033-1.TXT">AI05-0033-1</A></I>} 
<B>Correction:</B> Added a rule that using an access-to-protected-subprogram 
is erroneous if the associated object no longer exists. It is hard to 
imagine an alternative meaning here, and this has no effect on correct 
programs.</div>
<div class="paranum"><a name="p19.c">19.c/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0107-1.TXT">AI05-0107-1</A></I>} 
<B>Correction:</B> Moved the requirements on an implementation-generated 
call to Deallocate to <A HREF="AA-13-11.html">13.11</A>, in order to 
put all of the rules associated with implementation-generated calls to 
Allocate and Deallocate together.</div>
<div class="paranum"><a name="p19.d">19.d/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0157-1.TXT">AI05-0157-1</A></I>} 
<B>Correction:</B> Added wording so that calling an instance of Unchecked_Deallocation 
is treated similarly to <SPAN Class="swiss"><A HREF="AA-4-8.html#S0164">allocator</A></SPAN>s 
for access types where <SPAN Class="swiss"><A HREF="AA-4-8.html#S0164">allocator</A></SPAN>s 
would be banned.&nbsp;</div>

<H4 Class="centered">Inconsistencies With Ada 2012</H4>
<div class="paranum"><a name="p19.e">19.e/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<span class="insert4"><A NAME="I6507"></A><B>Corrigendum:</B> Defined 
a &quot;dangling reference&quot;, and specified that a dangling reference 
might designate some other existing object. This allows simple implementations 
of access values and reuse of object memory after deallocation. In prior 
versions of Ada, &quot;=&quot; between a dangling reference and an access 
to an existing object has to return False, even if the existing object 
and the object designated by the dangling reference are allocated in 
the same memory. A program that depended upon that could break with this 
revised rule. However, as a practical matter, almost all Ada implementations 
use simple implementations of access types that do not meet that requirement. 
So such a program would not work (consistently) on most Ada implementations; 
thus the change shouldn't break any existing programs - it just aligns 
the Standard with actual practice.</span></div>
<div class="paranum"><a name="p19.f">19.f/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<span class="insert4">A side effect of this change is to allow an Ada 
implementation to detect dangling references in more places. This does 
not require any Ada implementation to change, and if the implementation 
does change, it just means that errors will be detected earlier.</span> 
</div>

<H4 Class="centered">Wording Changes from Ada 2012</H4>
<div class="paranum"><a name="p19.g">19.g/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0148-1.TXT">AI12-0148-1</A></I>} 
<span class="insert4"><B>Corrigendum:</B> Clarified that deallocated 
objects cease to exist after finalization but before Deallocate is called. 
This is necessary to prevent erroneous execution from being triggered 
by the rules in <A HREF="AA-13-11.html">13.11</A> in the time between 
the end of finalization and the end of the call to the instance of Unchecked_Deallocation.</span> 
</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-13-11-1.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-13-11-3.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
