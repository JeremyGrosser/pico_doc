<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>The Package Interfaces.C.Strings</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.Indented2 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 5.8em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 4.3em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 4.0em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.Indented3Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Indented3Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.Indented2SmallBulleted-NoPrefix {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.8em; margin-right: 2.5em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Indented2SmallBulleted {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.8em; margin-right: 2.5em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.Indented4NestedBulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 9.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Indented4NestedBulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 9.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>B.3.1 The Package Interfaces.C.Strings</H1>
<div class="paranum"><a name="p1">1/3</a></div>
<div class="Normal">The package Interfaces.C.Strings declares types and 
subprograms allowing an Ada program to allocate, reference, update, and 
free C-style strings. In particular, the private type chars_ptr corresponds 
to a common use of &ldquo;char *&rdquo; in C programs, and an object 
of this type can be passed to a subprogram to which <TT><B>with</B> Import 
=&gt; True, Convention =&gt; C</TT> has been specified, and for which 
&ldquo;char *&rdquo; is the type of the argument of the C function.&nbsp;</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p2">2</a></div>
<div class="Normal" style="margin-bottom: 0.4em">The library package 
Interfaces.C.Strings has the following declaration:&nbsp;</div>
<div class="paranum"><a name="p3">3/5</a></div>
<div class="Examples"><B>package</B>&nbsp;Interfaces.C.Strings&nbsp;<A NAME="I8431"></A><BR>
&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;Preelaborate,&nbsp;Nonblocking,&nbsp;Global&nbsp;=&gt;&nbsp;<B>in&nbsp;out&nbsp;synchronized</B>&nbsp;<B>is</B></div>
<div class="paranum"><a name="p4">4</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I8432"></A>char_array_access&nbsp;<B>is</B>&nbsp;<B>access</B>&nbsp;<B>all</B>&nbsp;char_array;</div>
<div class="paranum"><a name="p5">5/5</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I8433"></A>chars_ptr&nbsp;<B>is</B>&nbsp;<B>private</B><BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>with</B>&nbsp;Preelaborable_Initialization;</div>
<div class="paranum"><a name="p6">6/2</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>type</B>&nbsp;<A NAME="I8434"></A>chars_ptr_array&nbsp;<B>is</B>&nbsp;<B>array</B>&nbsp;(size_t&nbsp;<B>range</B>&nbsp;&lt;&gt;)&nbsp;<B>of</B>&nbsp;<B>aliased</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p7">7</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I8435"></A>Null_Ptr&nbsp;:&nbsp;<B>constant</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p8">8</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8436"></A>To_Chars_Ptr&nbsp;(Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array_access;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nul_Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;False)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p9">9</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8437"></A>New_Char_Array&nbsp;(Chars&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array)&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p10">10</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8438"></A>New_String&nbsp;(Str&nbsp;:&nbsp;<B>in</B>&nbsp;String)&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p11">11</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I8439"></A>Free&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;<B>out</B>&nbsp;chars_ptr);</div>
<div class="paranum"><a name="p12">12</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I8440"></A>Dereference_Error&nbsp;:&nbsp;<B>exception</B>;</div>
<div class="paranum"><a name="p13">13</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8441"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;char_array;</div>
<div class="paranum"><a name="p14">14</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8442"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;char_array;</div>
<div class="paranum"><a name="p15">15</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8443"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;String;</div>
<div class="paranum"><a name="p16">16</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8444"></A>Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;String;</div>
<div class="paranum"><a name="p17">17</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>function</B>&nbsp;<A NAME="I8445"></A>Strlen&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;size_t;</div>
<div class="paranum"><a name="p18">18</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I8446"></A>Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chars&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</div>
<div class="paranum"><a name="p19">19</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<B>procedure</B>&nbsp;<A NAME="I8447"></A>Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Str&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;String;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</div>
<div class="paranum"><a name="p20">20</a></div>
<div class="Examples">&nbsp;&nbsp;&nbsp;<A NAME="I8448"></A>Update_Error&nbsp;:&nbsp;<B>exception</B>;</div>
<div class="paranum"><a name="p21">21</a></div>
<div class="Examples"><B>private</B><BR>
&nbsp;&nbsp;&nbsp;...&nbsp;--&nbsp;<SPAN Class="roman"><I>not&nbsp;specified&nbsp;by&nbsp;the&nbsp;language</I></SPAN><BR>
<B>end</B>&nbsp;Interfaces.C.Strings;</div>
<div class="paranum"><a name="p22">22</a></div>
<div class="Normal">The type chars_ptr is C-compatible and corresponds 
to the use of C's &ldquo;char *&rdquo; for a pointer to the first char 
in a char array terminated by nul. When an object of type chars_ptr is 
declared, its value is by default set to Null_Ptr, unless the object 
is imported (see <A HREF="RM-B-1.html">B.1</A>).&nbsp;</div>
<div class="paranum"><a name="p23">23</a></div>
<div class="Examples"><B>function</B>&nbsp;To_Chars_Ptr&nbsp;(Item&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array_access;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Nul_Check&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;False)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p24">24/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">If Item is <B>null</B>, 
then To_Chars_Ptr returns Null_Ptr. If Item is not <B>null</B>, Nul_Check 
is True, and Item.<B>all</B> does not contain nul, then the function 
propagates Terminator_Error; otherwise, To_Chars_Ptr performs a pointer 
conversion with no allocation of memory.</div>
<div class="paranum"><a name="p25">25</a></div>
<div class="Examples"><B>function</B>&nbsp;New_Char_Array&nbsp;(Chars&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array)&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p26">26</a></div>
<div class="Indented2">This function returns a pointer to an allocated 
object initialized to Chars(Chars'First .. Index) &amp; nul, where&nbsp;</div>
<div class="paranum"><a name="p27">27</a></div>
<div class="Indented3Bulleted">Index = Chars'Last if Chars does not contain 
nul, or</div>
<div class="paranum"><a name="p28">28</a></div>
<div class="Indented3Bulleted">Index is the smallest size_t value I such 
that Chars(I+1) = nul.&nbsp;</div>
<div class="paranum"><a name="p28.1">28.1</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">Storage_Error is 
propagated if the allocation fails.</div>
<div class="paranum"><a name="p29">29</a></div>
<div class="Examples"><B>function</B>&nbsp;New_String&nbsp;(Str&nbsp;:&nbsp;<B>in</B>&nbsp;String)&nbsp;<B>return</B>&nbsp;chars_ptr;</div>
<div class="paranum"><a name="p30">30</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">This function is 
equivalent to New_Char_Array(To_C(Str)).</div>
<div class="paranum"><a name="p31">31</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Free&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;<B>out</B>&nbsp;chars_ptr);</div>
<div class="paranum"><a name="p32">32</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">If Item is Null_Ptr, 
then Free has no effect. Otherwise, Free releases the storage occupied 
by Value(Item), and resets Item to Null_Ptr.</div>
<div class="paranum"><a name="p33">33</a></div>
<div class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;char_array;</div>
<div class="paranum"><a name="p34">34/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">If Item = Null_Ptr, 
then Value propagates Dereference_Error. Otherwise, Value returns the 
prefix of the array of chars pointed to by Item, up to and including 
the first nul. The lower bound of the result is 0. If Item does not point 
to a nul-terminated string, then execution of Value is erroneous.</div>
<div class="paranum"><a name="p35">35</a></div>
<div class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;char_array;</div>
<div class="paranum"><a name="p36">36/3</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">If Item = Null_Ptr, 
then Value propagates Dereference_Error. Otherwise, Value returns the 
shorter of two arrays, either the first Length chars pointed to by Item, 
or Value(Item). The lower bound of the result is 0. If Length is 0, then 
Value propagates Constraint_Error.&nbsp;</div>
<div class="paranum"><a name="p37">37</a></div>
<div class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;String;</div>
<div class="paranum"><a name="p38">38</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">Equivalent to To_Ada(Value(Item), 
Trim_Nul=&gt;True).</div>
<div class="paranum"><a name="p39">39</a></div>
<div class="Examples"><B>function</B>&nbsp;Value&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;&nbsp;Length&nbsp;:&nbsp;<B>in</B>&nbsp;size_t)<BR>
&nbsp;&nbsp;&nbsp;<B>return</B>&nbsp;String;</div>
<div class="paranum"><a name="p40">40/1</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">Equivalent to To_Ada(Value(Item, 
Length) &amp; nul, Trim_Nul=&gt;True).</div>
<div class="paranum"><a name="p41">41</a></div>
<div class="Examples"><B>function</B>&nbsp;Strlen&nbsp;(Item&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr)&nbsp;<B>return</B>&nbsp;size_t;</div>
<div class="paranum"><a name="p42">42</a></div>
<div class="Indented2" style="margin-bottom: 0.9em">Returns <I>Val</I>'Length&ndash;1 
where <I>Val</I> = Value(Item); propagates Dereference_Error if Item 
= Null_Ptr.&nbsp;</div>
<div class="paranum"><a name="p43">43</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Chars&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;char_array;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;Boolean&nbsp;:=&nbsp;True);</div>
<div class="paranum"><a name="p44">44/1</a></div>
<div class="Indented2" style="margin-bottom: 0.4em">If Item = Null_Ptr, 
then Update propagates Dereference_Error. Otherwise, this procedure updates 
the value pointed to by Item, starting at position Offset, using Chars 
as the data to be copied into the array. Overwriting the nul terminator, 
and skipping with the Offset past the nul terminator, are both prevented 
if Check is True, as follows:&nbsp;</div>
<div class="paranum"><a name="p45">45</a></div>
<div class="Indented3Bulleted">Let N = Strlen(Item). If Check is True, 
then:&nbsp;</div>
<div class="paranum"><a name="p46">46</a></div>
<div class="Indented4NestedBulleted">If Offset+Chars'Length&gt;N, propagate 
Update_Error.</div>
<div class="paranum"><a name="p47">47</a></div>
<div class="Indented4NestedBulleted">Otherwise, overwrite the data in 
the array pointed to by Item, starting at the char at position Offset, 
with the data in Chars.&nbsp;</div>
<div class="paranum"><a name="p48">48</a></div>
<div class="Indented3Bulleted" style="margin-bottom: 0.7em">If Check 
is False, then processing is as above, but with no check that Offset+Chars'Length&gt;N. 
</div>
<div class="paranum"><a name="p49">49</a></div>
<div class="Examples"><B>procedure</B>&nbsp;Update&nbsp;(Item&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;chars_ptr;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Offset&nbsp;:&nbsp;<B>in</B>&nbsp;size_t;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Str&nbsp;&nbsp;&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;String;<BR>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Check&nbsp;&nbsp;:&nbsp;<B>in</B>&nbsp;Boolean&nbsp;:=&nbsp;True);</div>
<div class="paranum"><a name="p50">50/2</a></div>
<div class="Indented2">Equivalent to Update(Item, Offset, To_C(Str, Append_Nul 
=&gt; False), Check).&nbsp;</div>

<H4 Class="centered">Erroneous Execution</H4>
<div class="paranum"><a name="p51">51</a></div>
<div class="Normal"><A NAME="I8449"></A>Execution of any of the following 
is erroneous if the Item parameter is not null_ptr and Item does not 
point to a nul-terminated array of chars.&nbsp;</div>
<div class="paranum"><a name="p52">52</a></div>
<div class="Bulleted">a Value function not taking a Length parameter,</div>
<div class="paranum"><a name="p53">53</a></div>
<div class="Bulleted">the Free procedure,</div>
<div class="paranum"><a name="p54">54</a></div>
<div class="Bulleted">the Strlen function.&nbsp;</div>
<div class="paranum"><a name="p55">55</a></div>
<div class="Normal"><A NAME="I8450"></A>Execution of Free(X) is also 
erroneous if the chars_ptr X was not returned by New_Char_Array or New_String.</div>
<div class="paranum"><a name="p56">56</a></div>
<div class="Normal"><A NAME="I8451"></A>Reading or updating a freed char_array 
is erroneous.</div>
<div class="paranum"><a name="p57">57</a></div>
<div class="Normal"><A NAME="I8452"></A>Execution of Update is erroneous 
if Check is False and a call with Check equal to True would have propagated 
Update_Error.&nbsp;</div>
<div class="paranum"><a name="p58">58/5</a></div>
<div class="Notes">NOTE&nbsp;&nbsp;&nbsp;New_Char_Array and New_String 
can be implemented either through the allocation function from the C 
environment (&ldquo;malloc&rdquo;) or through Ada dynamic memory allocation 
(&ldquo;new&rdquo;). The key points are&nbsp;</div>
<div class="paranum"><a name="p59">59/5</a></div>
<div class="Indented2SmallBulleted">the returned value (a chars_ptr) 
is represented as a C &ldquo;char *&rdquo; so that it can be passed to 
C functions;</div>
<div class="paranum"><a name="p60">60/5</a></div>
<div class="Indented2SmallBulleted">the allocated object can be freed 
by the programmer via a call of Free, rather than by calling a C function. 
</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-B-3-2.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
