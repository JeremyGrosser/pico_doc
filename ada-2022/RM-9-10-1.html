<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Conflict Check Policies</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-bottom: 0.6em}
    DIV.Indented4Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 9.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Indented4Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 9.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    DIV.WideHanging-Body {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 7.8em; margin-top: 0em; margin-bottom: 0.6em}
    DIV.WideHanging-Term {float: left; font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-top: 0em; margin-bottom: 0em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-10.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-11.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>9.10.1 Conflict Check Policies</H1>
<div class="paranum"><a name="p1">1/5</a></div>
<div class="Normal">This subclause determines what checks are performed 
relating to possible concurrent conflicting actions (see <A HREF="RM-9-10.html">9.10</A>).<A NAME="I4828"></A> 
</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum"><a name="p2">2/5</a></div>
<div class="Indented1" style="margin-bottom: 0.4em">The form of a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy is as follows:</div>
<div class="paranum"><a name="p3">3/5</a></div>
<div class="Indented1">&nbsp;&nbsp;<B>pragma</B> <A NAME="I4829"></A><A NAME="I4830"></A>Conflict_Check_Policy 
(<I>policy_</I><A NAME="I4831"></A><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>[, 
<I>policy_</I><A NAME="I4832"></A><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>]);</div>
<div class="paranum"><a name="p4">4/5</a></div>
<div class="Indented1">A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy is allowed only immediately within a <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN>, 
a <SPAN Class="swiss"><A HREF="RM-7-1.html#S0230">package_specification</A></SPAN>, 
or as a configuration pragma.</div>

<H4 Class="centered">Legality Rules</H4>
<div class="paranum"><a name="p5">5/5</a></div>
<div class="Normal">Each <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN> 
shall be one of No_Parallel_Conflict_Checks, Known_Parallel_Conflict_Checks, 
All_Parallel_Conflict_Checks, No_Tasking_Conflict_Checks, Known_Tasking_Conflict_Checks, 
All_Tasking_Conflict_Checks, No_Conflict_Checks, Known_Conflict_Checks, 
All_Conflict_Checks, or an implementation-defined conflict check policy. 
If two <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN>s 
are given, one shall include the word Parallel and one shall include 
the word Tasking. If only one <I>policy_</I><SPAN Class="swiss"><A HREF="RM-2-3.html#S0002">identifier</A></SPAN> 
is given, it shall not include the word Parallel or Tasking.</div>
<div class="paranum"><a name="p6">6/5</a></div>
<div class="Normal">A <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy given in a <SPAN Class="swiss"><A HREF="RM-3-11.html#S0086">declarative_part</A></SPAN> 
or immediately within a <SPAN Class="swiss"><A HREF="RM-7-1.html#S0230">package_specification</A></SPAN> 
applies from the place of the pragma to the end of the innermost enclosing 
declarative region. The region for a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy given as a configuration pragma is the declarative 
region for the entire compilation unit (or units) to which it applies.</div>
<div class="paranum"><a name="p7">7/5</a></div>
<div class="Normal">If a <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy applies to a <SPAN Class="swiss"><A HREF="RM-12-3.html#S0315">generic_instantiation</A></SPAN>, 
then the <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN> 
Conflict_Check_Policy applies to the entire instance.</div>
<div class="paranum"><a name="p8">8/5</a></div>
<div class="Normal">If multiple Conflict_Check_Policy pragmas apply to 
a given construct, the conflict check policy is determined by the one 
in the innermost enclosing region. If no Conflict_Check_Policy pragma 
applies to a construct, the policy is (All_Parallel_Conflict_Checks, 
No_Tasking_Conflict_Checks) (see below).</div>
<div class="paranum"><a name="p9">9/5</a></div>
<div class="Normal" style="margin-bottom: 0.4em">Certain potentially 
conflicting actions are disallowed according to which conflict check 
policies apply at the place where the action or actions occur, as follows:</div>
<div class="paranum"><a name="p10">10/5</a></div>
<div class="WideHanging-Term">No_Parallel_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
This policy imposes no restrictions on concurrent actions arising from 
<A NAME="I4833"></A>parallel constructs.</div>
<div class="paranum"><a name="p11">11/5</a></div>
<div class="WideHanging-Term">No_Tasking_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
This policy imposes no restrictions on concurrent actions arising from 
tasking <A NAME="I4834"></A>constructs.</div>
<div class="paranum"><a name="p12">12/5</a></div>
<div class="WideHanging-Term" style="margin-bottom: 0.4em">Known_Parallel_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
If this policy applies to two concurrent actions appearing within parallel 
constructs, <A NAME="I4835"></A>they are disallowed if they are known 
to denote the same object (see <A HREF="RM-6-4-1.html">6.4.1</A>) with 
uses that conflict. For the purposes of this check, any parallel loop 
may be presumed to involve multiple concurrent iterations. Also, for 
the purposes of deciding whether two actions are concurrent, it is enough 
for the logical threads of control in which they occur to be concurrent 
at any point in their execution, unless all of the following are true:</div>
<div class="paranum"><a name="p13">13/5</a></div>
<div class="Indented4Bulleted">the shared object is volatile;</div>
<div class="paranum"><a name="p14">14/5</a></div>
<div class="Indented4Bulleted">the two logical threads of control are 
both known to also refer to a shared synchronized object; and</div>
<div class="paranum"><a name="p15">15/5</a></div>
<div class="Indented4Bulleted">each thread whose potentially conflicting 
action updates the shared volatile object, also updates this shared synchronized 
object.</div>
<div class="paranum"><a name="p16">16/5</a></div>
<div class="WideHanging-Term" style="margin-bottom: 0.4em">Known_Tasking_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
If this policy applies to two concurrent actions appearing within <A NAME="I4836"></A>the 
same compilation unit, at least one of which appears within a task body 
but not within a parallel construct, they are disallowed if they are 
known to denote the same object (see <A HREF="RM-6-4-1.html">6.4.1</A>) 
with uses that conflict, and neither potentially signals the other (see 
<A HREF="RM-9-10.html">9.10</A>). For the purposes of this check, any 
named task type may be presumed to have multiple instances. Also, for 
the purposes of deciding whether two actions are concurrent, it is enough 
for the tasks in which they occur to be concurrent at any point in their 
execution, unless all of the following are true:</div>
<div class="paranum"><a name="p17">17/5</a></div>
<div class="Indented4Bulleted">the shared object is volatile;</div>
<div class="paranum"><a name="p18">18/5</a></div>
<div class="Indented4Bulleted">the two tasks are both known to also refer 
to a shared synchronized object; and</div>
<div class="paranum"><a name="p19">19/5</a></div>
<div class="Indented4Bulleted">each task whose potentially conflicting 
action updates the shared volatile object, also updates this shared synchronized 
object.</div>
<div class="paranum"><a name="p20">20/5</a></div>
<div class="WideHanging-Term">All_Parallel_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
This policy includes the restrictions imposed by the Known_Parallel_Conflict_Checks 
policy, and in <A NAME="I4837"></A>addition disallows a parallel construct 
from reading or updating a variable that is global to the construct, 
unless it is a synchronized object, or unless the construct is a parallel 
loop, and the global variable is a part of a component of an array denoted 
by an indexed component with at least one index expression that statically 
denotes the loop parameter of the <SPAN Class="swiss"><A HREF="RM-5-5.html#S0181">loop_parameter_specification</A></SPAN> 
or the chunk parameter of the parallel loop.</div>
<div class="paranum"><a name="p21">21/5</a></div>
<div class="WideHanging-Term">All_Tasking_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
This policy includes <A NAME="I4838"></A>the restrictions imposed by 
the Known_Tasking_Conflict_Checks policy, and in addition disallows a 
task body from reading or updating a variable that is global to the task 
body, unless it is a synchronized object.</div>
<div class="paranum"><a name="p22">22/5</a></div>
<div class="WideHanging-Term">No_Conflict_Checks, Known_Conflict_Checks, 
All_Conflict_Checks</div><div class="WideHanging-Body"><br clear="left">
These are shorthands for (No_Parallel_Conflict_Checks, <A NAME="I4839"></A>No_Tasking_Conflict_Checks), 
(Known_Parallel_Conflict_Checks, <A NAME="I4840"></A>Known_Tasking_Conflict_Checks), 
and (All_Parallel_Conflict_Checks, <A NAME="I4841"></A>All_Tasking_Conflict_Checks), 
respectively.</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p23">23/5</a></div>
<div class="Normal" style="margin-bottom: 0.4em">For a subprogram, the 
following language-defined representation aspect may be specified:</div>
<div class="paranum"><a name="p24">24/5</a></div>
<div class="WideHanging-Term">Parallel_Calls</div><div class="WideHanging-Body"><br clear="left">
The Parallel_Calls aspect is of type Boolean. The specified value shall 
be static. The Parallel_Calls aspect<A NAME="I4842"></A><A NAME="I4843"></A> 
of an inherited primitive subprogram is True if Parallel_Calls is True 
either for the corresponding subprogram of the progenitor type or for 
any other inherited subprogram that it overrides. If not specified or 
inherited as True, the Parallel_Calls aspect of a subprogram is False.</div>
<div class="paranum"><a name="p25">25/5</a></div>
<div class="WideHanging-Body">Specifying the Parallel_Calls aspect to 
be True for a subprogram indicates that the subprogram can be safely 
called in parallel. Conflict checks (if required by the Conflict_Check_Policy 
in effect) are made on the subprogram assuming that multiple concurrent 
calls exist. Such checks can then be omitted on a call of the subprogram 
in a parallel iteration context.</div>

<H4 Class="centered">Implementation Permissions</H4>
<div class="paranum"><a name="p26">26/5</a></div>
<div class="Normal">When the conflict check policy Known_Parallel_Conflict_Checks 
or All_Parallel_Conflict_Checks applies, the implementation may disallow 
two concurrent actions appearing within parallel constructs if the implementation 
can prove they will at run-time denote the same object with uses that 
conflict. Similarly, when the conflict check policy Known_Tasking_Conflict_Checks 
or All_Tasking_Conflict_Checks applies, the implementation may disallow 
two concurrent actions, at least one of which appears within a task body 
but not within a parallel construct, if the implementation can prove 
they will at run-time denote the same object with uses that conflict.</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-10.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-11.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
