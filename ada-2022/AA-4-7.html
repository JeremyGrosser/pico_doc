<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Qualified Expressions</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    SPAN.insert4 {text-decoration: underline; color: rgb(153,0,0) }
    SPAN.delete4 {text-decoration: line-through; color: rgb(153,0,0) }
    SPAN.insert5 {text-decoration: underline; color: rgb(0,102,0) }
    SPAN.delete5 {text-decoration: line-through; color: rgb(0,102,0) }
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 4.3em; margin-bottom: 0.6em}
    DIV.Annotations {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 6.8em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 4.0em; margin-bottom: 0.6em}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,51,153)"><B>Annotated</B></SPAN><SPAN Style="font-size:200%; color: rgb(0,0,102)"><B>&nbsp;Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="AA-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-4-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-4-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>4.7 Qualified Expressions</H1>
<div class="paranum"><a name="p1">1</a></div>
<div class="Normal">[A <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
is used to state explicitly the type, and to verify the subtype, of an 
operand that is either an <SPAN Class="swiss"><A HREF="AA-4-4.html#S0132">expression</A></SPAN> 
or an <SPAN Class="swiss"><A HREF="AA-4-3.html#S0106">aggregate</A></SPAN>. 
<A NAME="I3621"></A>]</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum"><a name="p2">2</a></div>
<div class="Indented1"><SPAN Class="swiss">qualified_expression</SPAN><A NAME="I3622"></A><A NAME="S0163"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><BR>
&nbsp;&nbsp;&nbsp;<A NAME="I3623"></A><SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>'(<A NAME="I3624"></A><SPAN Class="swiss"><A HREF="AA-4-4.html#S0132">expression</A></SPAN>)&nbsp;|&nbsp;<A NAME="I3625"></A><SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>'<A NAME="I3626"></A><SPAN Class="swiss"><A HREF="AA-4-3.html#S0106">aggregate</A></SPAN></div>

<H4 Class="centered">Name Resolution Rules</H4>
<div class="paranum"><a name="p3">3/5</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0325-1.TXT">AI12-0325-1</A></I>} 
<A NAME="I3627"></A>The <span class="insert5">expected type for the&nbsp;</span><I>operand</I> 
(the <SPAN Class="swiss"><A HREF="AA-4-4.html#S0132">expression</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-4-3.html#S0106">aggregate</A></SPAN>) 
<span class="insert5">is</span><span class="delete5">&nbsp;shall resolve to 
be of the type</span> determined by the <SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN><span class="delete5">, 
or a universal type that covers it</span>.<span class="insert5">&nbsp;Furthermore, 
the operand shall resolve to be either the specified expected type or 
a universal type that covers it.</span>&nbsp;</div>
<div class="paranum"><a name="p3.a">3.a/5</a></div>
<div class="Annotations"><span class="insert5"><B>Reason:&nbsp;</B></span>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0325-1.TXT">AI12-0325-1</A></I>} 
<span class="insert5">The first sentence defines the expected type for 
rules that assume one is defined. The second sentence prevents the use 
of the various implicit conversions that are usually allowed for expected 
types (except the one for numeric literals). The intent is that a qualified 
expression is similar to an assertion about the subtype of the operand, 
and thus implicit conversions would interfere with that intent.</span> 
</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p3.1">3.1/3</a></div>
<div class="Normal">&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0003-1.TXT">AI05-0003-1</A></I>} 
[If the operand of a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
denotes an object, the <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
denotes a constant view of that object.] The nominal subtype of a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
is the subtype denoted by the <SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>.<A NAME="I3628"></A> 
</div>
<div class="paranum"><a name="p3.b">3.b/3</a></div>
<div class="Annotations"><B>Proof:&nbsp;</B>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0003-1.TXT">AI05-0003-1</A></I>} 
This is stated in <A HREF="AA-3-3.html">3.3</A>.&nbsp;</div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum"><a name="p4">4/5</a></div>
<div class="Normal">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0100-1.TXT">AI12-0100-1</A></I>} 
{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0449-1.TXT">AI12-0449-1</A></I>} 
<A NAME="I3629"></A><A NAME="I3630"></A><A NAME="I3631"></A><A NAME="I3632"></A><A NAME="I3633"></A><A NAME="I3634"></A><A NAME="I3635"></A>The 
evaluation of a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
evaluates the operand (and if of a universal type, converts it to the 
type determined by the <SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>) 
and checks that its value belongs to the subtype denoted by the <SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>. 
<A NAME="I3636"></A><A NAME="I3637"></A>The exception Constraint_Error 
is raised if this check fails.<span class="insert4">&nbsp;Furthermore, if 
predicate checks are enabled for the subtype denoted by the <SPAN Class="swiss"><A HREF="AA-3-2-2.html#S0028">subtype_mark</A></SPAN>, 
a check is performed as defined in&nbsp;</span><span class="insert5"><A HREF="AA-3-2-4.html">3.2.4</A></span><span class="insert4"></span><span class="insert4"><span class="delete5">&nbsp;subclause 
<A HREF="AA-3-2-4.html">3.2.4</A>, &ldquo;<A HREF="AA-3-2-4.html">Subtype 
Predicates</A>&rdquo;</span></span><span class="insert4">&nbsp;that the value 
satifies the predicates of the subtype.</span>&nbsp;</div>
<div class="paranum"><a name="p4.a">4.a</a></div>
<div class="Annotations"><B>Ramification:&nbsp;</B>This is one of the few 
contexts in Ada 95 where implicit subtype conversion is not performed 
prior to a constraint check, and hence no &ldquo;sliding&rdquo; of array 
bounds is provided.</div>
<div class="paranum"><a name="p4.a.1">4.a.1/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0100-1.TXT">AI12-0100-1</A></I>} 
<span class="insert4">The effect of a failed predicate check is as defined 
in <A HREF="AA-3-2-4.html">3.2.4</A>; such a check could raise any exception, 
not just Constraint_Error or Assertion_Error.</span>&nbsp;</div>
<div class="paranum"><a name="p4.b">4.b</a></div>
<div class="Annotations"><B>Reason:&nbsp;</B>Implicit subtype conversion is 
not provided because a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
with a constrained target subtype is essentially an assertion about the 
subtype of the operand, rather than a request for conversion. An explicit 
<SPAN Class="swiss"><A HREF="AA-4-6.html#S0162">type_conversion</A></SPAN> 
can be used rather than a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
if subtype conversion is desired.</div>
<div class="paranum"><a name="p4.c">4.c/4</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0100-1.TXT">AI12-0100-1</A></I>} 
<span class="insert4">We do a predicate check here so that a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
never allows something that the equivalent <SPAN Class="swiss"><A HREF="AA-4-6.html#S0162">type_conversion</A></SPAN> 
would not allow.</span>&nbsp;</div>
<div class="paranum"><a name="p5">5/5</a></div>
<div class="Notes">NOTE&nbsp;&nbsp;&nbsp;{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0440-1.TXT">AI12-0440-1</A></I>} 
When a given context does not uniquely identify an expected type, a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
can be used to do so. In particular, if an overloaded <SPAN Class="swiss"><A HREF="AA-4-1.html#S0091">name</A></SPAN> 
or <SPAN Class="swiss"><A HREF="AA-4-3.html#S0106">aggregate</A></SPAN> 
is passed to an overloaded subprogram, it <span class="insert5">can</span><span class="delete5">&nbsp;might</span> 
be necessary to qualify the operand to resolve its type.&nbsp;</div>

<H4 Class="centered">Examples</H4>
<div class="paranum"><a name="p6">6</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><I>Examples of disambiguating 
expressions using qualification:</I>&nbsp;</div>
<div class="paranum"><a name="p7">7</a></div>
<div class="Examples"><B>type</B>&nbsp;Mask&nbsp;<B>is</B>&nbsp;(Fix,&nbsp;Dec,&nbsp;Exp,&nbsp;Signif);<BR>
<B>type</B>&nbsp;Code&nbsp;<B>is</B>&nbsp;(Fix,&nbsp;Cla,&nbsp;Dec,&nbsp;Tnz,&nbsp;Sub);</div>
<div class="paranum"><a name="p8">8</a></div>
<div class="Examples">Print&nbsp;(Mask'(Dec));&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;&nbsp;Dec&nbsp;is&nbsp;of&nbsp;type&nbsp;Mask</I></SPAN><BR>
Print&nbsp;(Code'(Dec));&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;&nbsp;Dec&nbsp;is&nbsp;of&nbsp;type&nbsp;Code&nbsp;</I></SPAN></div>
<div class="paranum"><a name="p9">9/5</a></div>
<div class="Examples">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0442-1.TXT">AI12-0442-1</A></I>} 
<B>for</B>&nbsp;J&nbsp;<B>in</B>&nbsp;Code'(Fix)&nbsp;..&nbsp;Code'(Dec)&nbsp;<B>loop</B>&nbsp;...&nbsp;<SPAN Class="roman"><I>--&nbsp;qualification&nbsp;</I></SPAN><span class="insert5"><SPAN Class="roman"><I>is&nbsp;necessary</I></SPAN></span><SPAN Class="roman"><I></I></SPAN><span class="delete5"><SPAN Class="roman"><I>&nbsp;needed</I></SPAN></span><SPAN Class="roman"><I>&nbsp;for&nbsp;either&nbsp;Fix&nbsp;or&nbsp;Dec</I></SPAN><BR>
<B>for</B>&nbsp;J&nbsp;<B>in</B>&nbsp;Code&nbsp;<B>range</B>&nbsp;Fix&nbsp;..&nbsp;Dec&nbsp;<B>loop</B>&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;qualification&nbsp;unnecessary</I></SPAN><BR>
<B>for</B>&nbsp;J&nbsp;<B>in</B>&nbsp;Code'(Fix)&nbsp;..&nbsp;Dec&nbsp;<B>loop</B>&nbsp;...&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<SPAN Class="roman"><I>--&nbsp;qualification&nbsp;unnecessary&nbsp;for&nbsp;Dec</I></SPAN></div>
<div class="paranum"><a name="p10">10</a></div>
<div class="Examples">Dozen'(1&nbsp;|&nbsp;3&nbsp;|&nbsp;5&nbsp;|&nbsp;7&nbsp;=&gt;&nbsp;2,&nbsp;<B>others</B>&nbsp;=&gt;&nbsp;0)&nbsp;<SPAN Class="roman"><I>--&nbsp;see&nbsp;<A HREF="AA-4-6.html">4.6</A>&nbsp;</I></SPAN></div>

<H4 Class="centered">Wording Changes from Ada 2005</H4>
<div class="paranum"><a name="p10.a">10.a/3</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI05s/AI05-0003-1.TXT">AI05-0003-1</A></I>} 
Added a definition of the nominal subtype of a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN>. 
</div>

<H4 Class="centered">Inconsistencies With Ada 2012</H4>
<div class="paranum"><a name="p10.b">10.b/5</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0100-1.TXT">AI12-0100-1</A></I>} 
<span class="insert4"></span>{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0005-1.TXT">AI12-0005-1</A></I>} 
<span class="insert4"><A NAME="I3638"></A><B>Corrigendum:</B> A <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
now performs a predicate check for the named subtype (if it is enabled). 
Original Ada 2012 did not include that check (an omission). While this 
is formally inconsistent (an exception could be raised when none would 
be raised by original Ada 2012), cases&nbsp;</span><span class="insert5">where</span><span class="insert4"></span><span class="insert4"><span class="delete5">&nbsp;when</span></span><span class="insert4">&nbsp;this&nbsp;</span><span class="insert5">scenario arises</span><span class="insert4"></span><span class="insert4"><span class="delete5">&nbsp;could 
be the case</span></span><span class="insert4">&nbsp;are likely to be rare 
(the qualified expression would have to have a stricter subtype than 
the following usage) and the check is more likely to detect bugs than 
be unexpected.</span>&nbsp;</div>

<H4 Class="centered">Wording Changes from Ada 2012</H4>
<div class="paranum"><a name="p10.c">10.c/5</a></div>
<div class="Annotations">{<I><A HREF="http://www.ada-auth.org/cgi-bin/cvsweb.cgi/AI12s/AI12-0325-1.TXT">AI12-0325-1</A></I>} 
<span class="insert5">Reworded the resolution rule so that the operand 
of a <SPAN Class="swiss"><A HREF="AA-4-7.html#S0163">qualified_expression</A></SPAN> 
has an expected type. This eliminates an annoying inconsistency in the 
language definition.</span>&nbsp;</div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="AA-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-4-6.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="AA-4-8.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
