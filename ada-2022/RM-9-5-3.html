<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<HTML>
<HEAD>
    <TITLE>Entry Calls</TITLE>
    <META http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
    <META NAME="Author" CONTENT="JTC1/SC22/WG9/ARG, by Randall Brukardt, ARG Editor">
    <META NAME="GENERATOR" CONTENT="Arm_Form.Exe, Ada Reference Manual generator">
    <STYLE type="text/css">
    H4.centered {text-align: center}
    SPAN.swiss {font-family: Arial, Helvetica, sans-serif; font-size: 92%}
    SPAN.roman {font-family: "Times New Roman", Times, serif}
    DIV.paranum {float: left; font-family: Arial, Helvetica, sans-serif; font-size: 64%; width: 2.8em; margin-left: -0.4em; margin-right: -3.0em; margin-top: 0.2em}
    TT {font-family: "Courier New", monospace}
    DT {display: compact}
    A.Bar:link {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    A.Bar:visited {font-family: Arial, Helvetica, sans-serif; font-style: normal; text-decoration: none; color: rgb(204,204,51)}
    DIV.Normal {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 1.8em; margin-bottom: 0.6em}
    DIV.Indented1 {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-bottom: 0.6em}
    DIV.Notes {font-family: "Times New Roman", Times, serif; font-size: 80%; line-height: 122%; margin-left: 4.3em; margin-bottom: 0.6em}
    DIV.Examples {font-family: "Courier New", monospace; font-size: 90%; line-height: 122%; margin-left: 4.0em; margin-bottom: 0.6em}
    DIV.Bulleted-NoPrefix {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em}
    DIV.Bulleted {font-family: "Times New Roman", Times, serif; line-height: 122%; margin-left: 3.8em; margin-right: 2.0em; margin-top: 0em; margin-bottom: 0.5em; display: list-item; list-style-type: disc}
    </STYLE>
</HEAD>
<BODY TEXT="#000000" BGCOLOR="#FFFFF0" LINK="#000080" VLINK="#330033" ALINK="#0000FF">
<DIV><SPAN Style="font-size:200%; color: rgb(0,0,153)"><B>Ada Reference Manual</B> (Ada 2022 Draft 35)</SPAN> &mdash; <A HREF="RM-TTL.html"><B>Legal Information</B></A></DIV>
<div style="margin-top: 0.6em; margin-bottom: 0.0em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-5-2.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-5-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<HR>
<H1>9.5.3 Entry Calls</H1>
<div class="paranum"><a name="p1">1</a></div>
<div class="Normal"><A NAME="I4589"></A>An <SPAN Class="swiss"><A HREF="RM-9-5-3.html#S0264">entry_call_statement</A></SPAN> 
(an <I>entry call</I>) can appear in various contexts. <A NAME="I4590"></A><A NAME="I4591"></A>A 
<I>simple</I> entry call is a stand-alone statement that represents an 
unconditional call on an entry of a target task or a protected object. 
Entry calls can also appear as part of <SPAN Class="swiss"><A HREF="RM-9-7.html#S0269">select_statement</A></SPAN>s 
(see <A HREF="RM-9-7.html">9.7</A>).&nbsp;</div>

<H4 Class="centered">Syntax</H4>
<div class="paranum"><a name="p2">2</a></div>
<div class="Indented1"><SPAN Class="swiss">entry_call_statement</SPAN><A NAME="I4592"></A><A NAME="S0264"></A><SPAN Class="swiss">&nbsp;::=&nbsp;</SPAN><I>entry_</I><A NAME="I4593"></A><SPAN Class="swiss"><A HREF="RM-4-1.html#S0091">name</A></SPAN>&nbsp;[<A NAME="I4594"></A><SPAN Class="swiss"><A HREF="RM-6-4.html#S0219">actual_parameter_part</A></SPAN>];</div>

<H4 Class="centered">Name Resolution Rules</H4>
<div class="paranum"><a name="p3">3</a></div>
<div class="Normal">The <I>entry_</I><SPAN Class="swiss"><A HREF="RM-4-1.html#S0091">name</A></SPAN> 
given in an <SPAN Class="swiss"><A HREF="RM-9-5-3.html#S0264">entry_call_statement</A></SPAN> 
shall resolve to denote an entry. The rules for parameter associations 
are the same as for subprogram calls (see <A HREF="RM-6-4.html">6.4</A> 
and <A HREF="RM-6-4-1.html">6.4.1</A>).&nbsp;</div>

<H4 Class="centered">Static Semantics</H4>
<div class="paranum"><a name="p4">4</a></div>
<div class="Normal">The <I>entry_</I><SPAN Class="swiss"><A HREF="RM-4-1.html#S0091">name</A></SPAN> 
of an <SPAN Class="swiss"><A HREF="RM-9-5-3.html#S0264">entry_call_statement</A></SPAN> 
specifies (explicitly or implicitly) the target object of the call, the 
entry or entry family, and the entry index, if any (see <A HREF="RM-9-5.html">9.5</A>). 
</div>

<H4 Class="centered">Dynamic Semantics</H4>
<div class="paranum"><a name="p5">5</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><A NAME="I4595"></A><A NAME="I4596"></A><A NAME="I4597"></A><A NAME="I4598"></A>Under 
certain circumstances (detailed below), an entry of a task or protected 
object is checked to see whether it is <I>open</I> or <I>closed</I>: 
</div>
<div class="paranum"><a name="p6">6/3</a></div>
<div class="Bulleted"><A NAME="I4599"></A><A NAME="I4600"></A>An entry 
of a task is open if the task is blocked on an <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN> 
that corresponds to the entry (see <A HREF="RM-9-5-2.html">9.5.2</A>), 
or on a <SPAN Class="swiss"><A HREF="RM-9-7-1.html#S0270">selective_accept</A></SPAN> 
(see <A HREF="RM-9-7-1.html">9.7.1</A>) with an open <SPAN Class="swiss"><A HREF="RM-9-7-1.html#S0273">accept_alternative</A></SPAN> 
that corresponds to the entry; otherwise, it is closed.</div>
<div class="paranum"><a name="p7">7/3</a></div>
<div class="Bulleted"><A NAME="I4601"></A><A NAME="I4602"></A>An entry 
of a protected object is open if the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
of the <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0262">entry_barrier</A></SPAN> 
of the corresponding <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
evaluates to True; otherwise, it is closed. <A NAME="I4603"></A>If the 
evaluation of the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
propagates an exception, the exception Program_Error is propagated to 
all current callers of all entries of the protected object.&nbsp;</div>
<div class="paranum"><a name="p8">8</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><A NAME="I4604"></A>For 
the execution of an <SPAN Class="swiss"><A HREF="RM-9-5-3.html#S0264">entry_call_statement</A></SPAN>, 
evaluation of the <SPAN Class="swiss"><A HREF="RM-4-1.html#S0091">name</A></SPAN> 
and of the parameter associations is as for a subprogram call (see <A HREF="RM-6-4.html">6.4</A>). 
<A NAME="I4605"></A>The entry call is then <I>issued</I>: For a call 
on an entry of a protected object, a new protected action is started 
on the object (see <A HREF="RM-9-5-1.html">9.5.1</A>). The named entry 
is checked to see if it is open; <A NAME="I4606"></A>if open, the entry 
call is said to be <I>selected immediately</I>, and the execution of 
the call proceeds as follows:&nbsp;</div>
<div class="paranum"><a name="p9">9</a></div>
<div class="Bulleted">For a call on an open entry of a task, the accepting 
task becomes ready and continues the execution of the corresponding <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN> 
(see <A HREF="RM-9-5-2.html">9.5.2</A>).</div>
<div class="paranum"><a name="p10">10</a></div>
<div class="Bulleted">For a call on an open entry of a protected object, 
the corresponding <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
is executed (see <A HREF="RM-9-5-2.html">9.5.2</A>) as part of the protected 
action.&nbsp;</div>
<div class="paranum"><a name="p11">11</a></div>
<div class="Normal">If the <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN> 
or <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
completes other than by a requeue (see <A HREF="RM-9-5-4.html">9.5.4</A>), 
return is made to the caller (after servicing the entry queues &mdash; 
see below); any necessary assigning back of formal to actual parameters 
occurs, as for a subprogram call (see <A HREF="RM-6-4-1.html">6.4.1</A>); 
such assignments take place outside of any protected action.&nbsp;</div>
<div class="paranum"><a name="p12">12</a></div>
<div class="Normal">If the named entry is closed, the entry call is added 
to an <I>entry queue</I> (as part of the protected action, for a call 
on a protected entry), and the call remains queued until it is selected 
or cancelled; <A NAME="I4607"></A>there is a separate (logical) entry 
queue for each entry of a given task or protected object (including each 
entry of an entry family).</div>
<div class="paranum"><a name="p13">13</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><A NAME="I4608"></A><A NAME="I4609"></A>When 
a queued call is <I>selected</I>, it is removed from its entry queue. 
Selecting a queued call from a particular entry queue is called <I>servicing</I> 
the entry queue. An entry with queued calls can be serviced under the 
following circumstances:&nbsp;</div>
<div class="paranum"><a name="p14">14</a></div>
<div class="Bulleted">When the associated task reaches a corresponding 
<SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN>, 
or a <SPAN Class="swiss"><A HREF="RM-9-7-1.html#S0270">selective_accept</A></SPAN> 
with a corresponding open <SPAN Class="swiss"><A HREF="RM-9-7-1.html#S0273">accept_alternative</A></SPAN>;</div>
<div class="paranum"><a name="p15">15/4</a></div>
<div class="Bulleted">If after performing, as part of a protected action 
on the associated protected object, an exclusive protected operation 
on the object, the entry is checked and found to be open.&nbsp;</div>
<div class="paranum"><a name="p16">16</a></div>
<div class="Normal"><A NAME="I4610"></A>If there is at least one call 
on a queue corresponding to an open entry, then one such call is selected 
according to the <I>entry queuing policy</I> in effect (see below), and 
the corresponding <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN> 
or <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
is executed as above for an entry call that is selected immediately.</div>
<div class="paranum"><a name="p17">17</a></div>
<div class="Normal"><A NAME="I4611"></A>The entry queuing policy controls 
selection among queued calls both for task and protected entry queues. 
<A NAME="I4612"></A><A NAME="I4613"></A>The default entry queuing policy 
is to select calls on a given entry queue in order of arrival. If calls 
from two or more queues are simultaneously eligible for selection, the 
default entry queuing policy does not specify which queue is serviced 
first. Other entry queuing policies can be specified by <SPAN Class="swiss"><A HREF="RM-2-8.html#S0019">pragma</A></SPAN>s 
(see <A HREF="RM-D-4.html">D.4</A>).</div>
<div class="paranum"><a name="p18">18</a></div>
<div class="Normal">For a protected object, the above servicing of entry 
queues continues until there are no open entries with queued calls, at 
which point the protected action completes.&nbsp;</div>
<div class="paranum"><a name="p19">19</a></div>
<div class="Normal"><A NAME="I4614"></A>For an entry call that is added 
to a queue, and that is not the <SPAN Class="swiss"><A HREF="RM-9-7-4.html#S0282">triggering_statement</A></SPAN> 
of an <SPAN Class="swiss"><A HREF="RM-9-7-4.html#S0280">asynchronous_select</A></SPAN> 
(see <A HREF="RM-9-7-4.html">9.7.4</A>), the calling task is blocked 
until the call is cancelled, or the call is selected and a corresponding 
<SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0258">accept_statement</A></SPAN> 
or <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
completes without requeuing. In addition, the calling task is blocked 
during a rendezvous.</div>
<div class="paranum"><a name="p20">20</a></div>
<div class="Normal"><A NAME="I4615"></A>An attempt can be made to cancel 
an entry call upon an abort (see <A HREF="RM-9-8.html">9.8</A>) and as 
part of certain forms of <SPAN Class="swiss"><A HREF="RM-9-7.html#S0269">select_statement</A></SPAN> 
(see <A HREF="RM-9-7-2.html">9.7.2</A>, <A HREF="RM-9-7-3.html">9.7.3</A>, 
and <A HREF="RM-9-7-4.html">9.7.4</A>). The cancellation does not take 
place until a point (if any) when the call is on some entry queue, and 
not protected from cancellation as part of a requeue (see <A HREF="RM-9-5-4.html">9.5.4</A>); 
at such a point, the call is removed from the entry queue and the call 
completes due to the cancellation. The cancellation of a call on an entry 
of a protected object is a protected action, and as such cannot take 
place while any other protected action is occurring on the protected 
object. Like any protected action, it includes servicing of the entry 
queues (in case some entry barrier depends on a Count attribute).&nbsp;</div>
<div class="paranum"><a name="p21">21</a></div>
<div class="Normal"><A NAME="I4616"></A><A NAME="I4617"></A><A NAME="I4618"></A>A 
call on an entry of a task that has already completed its execution raises 
the exception Tasking_Error at the point of the call; similarly, this 
exception is raised at the point of the call if the called task completes 
its execution or becomes abnormal before accepting the call or completing 
the rendezvous (see <A HREF="RM-9-8.html">9.8</A>). This applies equally 
to a simple entry call and to an entry call as part of a <SPAN Class="swiss"><A HREF="RM-9-7.html#S0269">select_statement</A></SPAN>.</div>

<H4 Class="centered">Implementation Permissions</H4>
<div class="paranum"><a name="p22">22/5</a></div>
<div class="Normal">An implementation may perform the sequence of steps 
of a protected action using any thread of control; it can be a thread 
other than that of the task that started the protected action. If an 
<SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN> 
completes without requeuing, then the corresponding calling task may 
be made ready without waiting for the entire protected action to complete. 
</div>
<div class="paranum"><a name="p23">23/5</a></div>
<div class="Normal">When the entry of a protected object is checked to 
see whether it is open, the implementation can bypass reevaluating the 
<SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
of the corresponding <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0262">entry_barrier</A></SPAN> 
if no variable or attribute referenced by the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
(directly or indirectly) has been altered by the execution (or cancellation) 
of a call to an exclusive protected operation of the object since the 
<SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
was last evaluated.&nbsp;</div>
<div class="paranum"><a name="p24">24</a></div>
<div class="Normal">An implementation may evaluate the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN>s 
of all <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0262">entry_barrier</A></SPAN>s 
of a given protected object any time any entry of the object is checked 
to see if it is open.&nbsp;</div>
<div class="paranum"><a name="p25">25/5</a></div>
<div class="Normal">When an attempt is made to cancel an entry call, 
the implementation can use a thread of control other than that of the 
task (or interrupt) that initiated the cancellation; in particular, it 
may use the thread of control of the caller itself to attempt the cancellation, 
even if this can allow the entry call to be selected in the interim. 
</div>
<div class="paranum"><a name="p26">26</a></div>
<div class="Notes">NOTE 1&nbsp;&nbsp;&nbsp;If an exception is raised 
during the execution of an <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0260">entry_body</A></SPAN>, 
it is propagated to the corresponding caller (see <A HREF="RM-11-4.html">11.4</A>).</div>
<div class="paranum"><a name="p27">27</a></div>
<div class="Notes">NOTE 2&nbsp;&nbsp;&nbsp;For a call on a protected 
entry, the entry is checked to see if it is open prior to queuing the 
call, and again thereafter if its Count attribute (see <A HREF="RM-9-9.html">9.9</A>) 
is referenced in some entry barrier.&nbsp;</div>
<div class="paranum"><a name="p28">28</a></div>
<div class="Notes">NOTE 3&nbsp;&nbsp;&nbsp;In addition to simple entry 
calls, the language permits timed, conditional, and asynchronous entry 
calls (see <A HREF="RM-9-7-2.html">9.7.2</A>, <A HREF="RM-9-7-3.html">9.7.3</A>, 
and see <A HREF="RM-9-7-4.html">9.7.4</A>).&nbsp;</div>
<div class="paranum"><a name="p29">29/5</a></div>
<div class="Notes">NOTE 4&nbsp;&nbsp;&nbsp;The <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
of an <SPAN Class="swiss"><A HREF="RM-9-5-2.html#S0262">entry_barrier</A></SPAN> 
is allowed to be evaluated by an implementation more often than strictly 
necessary, even if the evaluation can have side effects. On the other 
hand, an implementation can avoid reevaluating the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
if nothing it references was updated by an intervening protected action 
on the protected object, even if the <SPAN Class="swiss"><A HREF="RM-4-5-7.html#S0150">condition</A></SPAN> 
references some global variable that is updated by an action performed 
from outside of a protected action.&nbsp;</div>

<H4 Class="centered">Examples</H4>
<div class="paranum"><a name="p30">30</a></div>
<div class="Normal" style="margin-bottom: 0.4em"><I>Examples of entry 
calls:</I>&nbsp;</div>
<div class="paranum"><a name="p31">31</a></div>
<div class="Examples">Agent.Shut_Down;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;see&nbsp;<A HREF="RM-9-1.html">9.1</A></I></SPAN><BR>
Parser.Next_Lexeme(E);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;see&nbsp;<A HREF="RM-9-1.html">9.1</A></I></SPAN><BR>
Pool(5).Read(Next_Char);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;see&nbsp;<A HREF="RM-9-1.html">9.1</A></I></SPAN><BR>
Controller.Request(Low)(Some_Item);&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;see&nbsp;<A HREF="RM-9-1.html">9.1</A></I></SPAN><BR>
Flags(3).Seize;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;--<SPAN Class="roman"><I>&nbsp;&nbsp;see&nbsp;<A HREF="RM-9-4.html">9.4</A></I></SPAN></div>

<HR>
<div style="margin-top: 0.0em; margin-bottom: 0.6em"><A HREF="RM-TOC.html"><IMG SRC="cont.gif" ALT="Contents" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-0-4.html"><IMG SRC="index.gif" ALT="Index" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-STDS.html"><IMG SRC="lib.gif" ALT="References" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-SRCH.html"><IMG SRC="find.gif" ALT="Search" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-5-2.html"><IMG SRC="prev.gif" ALT="Previous" BORDER=0></A>&nbsp;
&nbsp;<A HREF="RM-9-5-4.html"><IMG SRC="next.gif" ALT="Next" BORDER=0></A>&nbsp;
</div>
<DIV Style="margin-top:0.0em"><IMG SRC="AE_logo.gif" height=100 width=113 align=right ALT="Ada-Europe">
<SPAN Style="vertical-align: middle; font-size:120%">Ada 2005 and 2012 Editions sponsored in part by <SPAN Style="font-size: 125%"><A HREF="http://www.ada-europe.org/"><B>Ada-Europe</B></A></SPAN></SPAN></DIV>
</BODY>
</HTML>
