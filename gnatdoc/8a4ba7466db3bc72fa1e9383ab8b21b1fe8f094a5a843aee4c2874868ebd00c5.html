<!DOCTYPE html>
<html class=main>
<link rel=stylesheet href=gnatdoc.css><body class=content><h1>BBqueue.Buffers</h1><h2>Entities</h2><h3>Simple Types</h3><ul><li><a href=#6a257c5617e94daa6ffcfbb44fb300d2a9847da5d92af6a9b695f8dfdfad0cae>Buffer</a><li><a href=#f0007b561ac03362047c0be3602c30bddf88a115c028b7c385a20a4a3342048c>Read_Grant</a><li><a href=#6cab7313fd20fcc48efa3d7816ea97fff9bb23dc05d35ba701b5be82a4a72ee5>Write_Grant</a></ul><h3>Record Types</h3><ul><li><a href=#86653751ef98f8d35ec30db53b8dccd0a505a7038b8667c5b2293dac72d179ae>Slice_Rec</a></ul><h3>Subprograms</h3><ul><li><a href=#8daada798d186e401de3f8fb8a7bb6d5f7f8b0a04b8b7e80294118ce2b0dc62f>Commit</a><li><a href=#3375d87e98ec7db9e4f71e212392e2c8b0889293f3afd290087e456562959191>Empty</a><li><a href=#3ff26783004910f06db40ec0fe257f65c7f46f22aa55208ec3dab6bb0d249a26>Empty</a><li><a href=#287b35e39480a638a975e212327a66a8118e9c875546066a7c073eae0ad69c68>Grant</a><li><a href=#caab083a842357c98b62ee6b305dc3c906056dae26fc7c92f88dc213f896ae6d>Read</a><li><a href=#8148a7f029b1d20f996c8cfd61585856407fbced09afb058823c95dc4dcca035>Read_Grant_In_Progress</a><li><a href=#776c87d92aa518f45f9a653de0306d7070954dcc09b8b0ce8f7f1853934538fd>Release</a><li><a href=#75d98549e7403b1e08fc7f90fbcc34ec0f349354a33c5a2de2ef095a4c1c9d48>Slice</a><li><a href=#73590ec6cf94f7881184e3417c8a861a54156b719718b23cd704f6ed800f98ad>Slice</a><li><a href=#f68bf155b498e7eeeea2512b12344f0a4d07480a7a0eb0e1a88a11d0635cec38>State</a><li><a href=#ca37fc1a15c964ec2f9e8c42479093feb17527f0109cb63012b375e23740285c>State</a><li><a href=#4ad8ac55f68499b41518d6b2317e9f5383a94a6febc30ccb92e35a441c301acc>Write_Grant_In_Progress</a></ul><h2>Description</h2><p>This unit is based on BBqueue.Offsets_Only and embeds an internal buffer. It provides directly usable slices of memory from its internal buffer:<pre><code>Q : aliased Buffer (64); G : Write_Grant := Empty; : Slice_Rec;</code></pre><p>begin Grant (Q, WG, 8); if State (WG) = Valid then declare B : Storage_Array (1 .. Slice (WG).Length) with Address => Slice (WG).Addr; begin B := (others => 42); end; Commit (Q, WG); end if;<h4 id=6a257c5617e94daa6ffcfbb44fb300d2a9847da5d92af6a9b695f8dfdfad0cae>Buffer</h4><pre class=ada-code-snippet><code>type Buffer (Size   : Buffer_Size)
is limited private;
</code></pre><h4 id=8daada798d186e401de3f8fb8a7bb6d5f7f8b0a04b8b7e80294118ce2b0dc62f>Commit</h4><pre class=ada-code-snippet><code>procedure Commit (This : in out Buffer;
                  G    : in out Write_Grant;
                  Size :        Count := Count'Last)
</code></pre><p>Commit a writeable slice. Size can be smaller than the granted slice for partial commits. The commited slice is then available for Read.<h5>Parameters</h5><dl><dt>This<dd><dt>G<dd><dt>Size<dd></dl><h4 id=3375d87e98ec7db9e4f71e212392e2c8b0889293f3afd290087e456562959191>Empty</h4><pre class=ada-code-snippet><code>function Empty return Read_Grant
</code></pre><h5>Return Value</h5><dl><dd></dl><h4 id=3ff26783004910f06db40ec0fe257f65c7f46f22aa55208ec3dab6bb0d249a26>Empty</h4><pre class=ada-code-snippet><code>function Empty return Write_Grant
</code></pre><h5>Return Value</h5><dl><dd></dl><h4 id=287b35e39480a638a975e212327a66a8118e9c875546066a7c073eae0ad69c68>Grant</h4><pre class=ada-code-snippet><code>procedure Grant (This : in out Buffer;
                 G    : in out Write_Grant;
                 Size : Count)
</code></pre><p>Request a contiguous writeable slice of the internal buffer<h5>Parameters</h5><dl><dt>This<dd><dt>G<dd><dt>Size<dd></dl><h4 id=caab083a842357c98b62ee6b305dc3c906056dae26fc7c92f88dc213f896ae6d>Read</h4><pre class=ada-code-snippet><code>procedure Read (This : in out Buffer;
                G    : in out Read_Grant;
                Max  :        Count := Count'Last)
</code></pre><p>Request contiguous readable slice of up to Max elements from the internal buffer.<h5>Parameters</h5><dl><dt>This<dd><dt>G<dd><dt>Max<dd></dl><h4 id=f0007b561ac03362047c0be3602c30bddf88a115c028b7c385a20a4a3342048c>Read_Grant</h4><pre class=ada-code-snippet><code>type Read_Grant is limited private;
</code></pre><h4 id=8148a7f029b1d20f996c8cfd61585856407fbced09afb058823c95dc4dcca035>Read_Grant_In_Progress</h4><pre class=ada-code-snippet><code>function Read_Grant_In_Progress (This : Buffer) return Boolean
</code></pre><h5>Parameters</h5><dl><dt>This<dd></dl><h5>Return Value</h5><dl><dd></dl><h4 id=776c87d92aa518f45f9a653de0306d7070954dcc09b8b0ce8f7f1853934538fd>Release</h4><pre class=ada-code-snippet><code>procedure Release (This : in out Buffer;
                   G    : in out Read_Grant;
                   Size :        Count := Count'Last)
</code></pre><p>Release a readable slice. Size can be smaller than the granted slice for partial releases.<h5>Parameters</h5><dl><dt>This<dd><dt>G<dd><dt>Size<dd></dl><h4 id=75d98549e7403b1e08fc7f90fbcc34ec0f349354a33c5a2de2ef095a4c1c9d48>Slice</h4><pre class=ada-code-snippet><code>function Slice (G : Read_Grant) return Slice_Rec
</code></pre><h5>Parameters</h5><dl><dt>G<dd></dl><h5>Return Value</h5><dl><dd></dl><h4 id=73590ec6cf94f7881184e3417c8a861a54156b719718b23cd704f6ed800f98ad>Slice</h4><pre class=ada-code-snippet><code>function Slice (G : Write_Grant) return Slice_Rec
</code></pre><h5>Parameters</h5><dl><dt>G<dd></dl><h5>Return Value</h5><dl><dd></dl><h4 id=86653751ef98f8d35ec30db53b8dccd0a505a7038b8667c5b2293dac72d179ae>Slice_Rec</h4><pre class=ada-code-snippet><code>type Slice_Rec is record
   Length : Count;
   Addr   : System.Address;
end record;
</code></pre><h5>Record fields</h5><dl><dt>Length<dd><dt>Addr<dd></dl><h4 id=f68bf155b498e7eeeea2512b12344f0a4d07480a7a0eb0e1a88a11d0635cec38>State</h4><pre class=ada-code-snippet><code>function State (G : Read_Grant) return Result_Kind
</code></pre><h5>Parameters</h5><dl><dt>G<dd></dl><h5>Return Value</h5><dl><dd></dl><h4 id=ca37fc1a15c964ec2f9e8c42479093feb17527f0109cb63012b375e23740285c>State</h4><pre class=ada-code-snippet><code>function State (G : Write_Grant) return Result_Kind
</code></pre><h5>Parameters</h5><dl><dt>G<dd></dl><h5>Return Value</h5><dl><dd></dl><h4 id=6cab7313fd20fcc48efa3d7816ea97fff9bb23dc05d35ba701b5be82a4a72ee5>Write_Grant</h4><pre class=ada-code-snippet><code>type Write_Grant is limited private;
</code></pre><h4 id=4ad8ac55f68499b41518d6b2317e9f5383a94a6febc30ccb92e35a441c301acc>Write_Grant_In_Progress</h4><pre class=ada-code-snippet><code>function Write_Grant_In_Progress (This : Buffer) return Boolean
</code></pre><h5>Parameters</h5><dl><dt>This<dd></dl><h5>Return Value</h5><dl><dd></dl>